---
title: "03_describe.qmd"
editor: visual
format:
  html:
    embed-resources: true
author: "Sarah Rosenberg Asmussen (s194689),	Mette BÃ¸ge Pedersen (s194679),	Caroline Amalie Bastholm Jensen (s213427), Jaime Noguera Piera (s233773), Yassine Turki (s231735)"
---

## Data description

Data is available here: [NCBI](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE31684)

The article published based on the data is available here: [PMC](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3569085/)

**The title of the article is:**

*Combination of a novel gene expression signature with a clinical nomogram improves the prediction of survival in high-risk bladder cancer*

A nomogram is a method to graphically depict a statistical prognostic model that generates a probability of a clinical event, such as cancer recurrence or death.

Urothelial carcinoma of the urinary bladder is the fifth most common cancer in the Western World, and represents 3% of cancers diagnosed globally.

#### About the data we use

Cancer gene expression data from 93 patients undergoing radical cystectomy (RC) between 1993 and 2004. Lymph node dissection was performed in 77 patients; no patient has metastatic disease at the time of RC. Metastatic disease means that the cancer has spread to a different part of the body than where it started. Case selection was restricted to those with frozen specimens with measurable volume of malignancy and adequate percentage of tumor.

## Data load

```{r}
#| warning: false
#| output: false
data_describe <- read_tsv("../data/02_dat_clean_wide.tsv",
                            show_col_types = FALSE)

data_describe
```

## Counting number of genes

```{r}
number_of_genes <- data_describe |> 
  select(c(GEO, ends_with("_at"))) |> 
  pivot_longer(cols = -GEO,
               names_to = "Genes",
               values_to = "Gene_expression") |> 
  distinct(Genes) |> 
  count()

number_of_genes
```

## Table visualizing meta data

```{r}
table_data <- data_describe |> 
  mutate(Metastasis = factor(Metastasis)) |> 
  table1(x = formula(~ Smoking + Metastasis), 
         data = _,
         caption = "Overview of number of patients who have metastasis and smoking status")

table_data
```

```{r}
# this doesn't work
ggsave(
  filename = "../results/04_table_data.pdf",
  plot = table_data,
  device = "pdf")

print(table_data)

dev.off()
```
