---
title: "01_load.qmd"
format: html
editor: visual
---

```{r}
#| output: false
#| warning: false
library(tidyverse)
library(httr)
```

## Download data

```{r}
#| warn: false
meta_url <- "https://ftp.ncbi.nlm.nih.gov/geo/series/GSE31nnn/GSE31684/suppl/GSE31684%5Ftable%5Fof%5Fclinical%5Fdetails.txt.gz"

if (file.exists("data/GSE31684_meta_data.csv")){
  # Unzip and read the contents using tidyverse functions
  meta_data <- read_csv("data/GSE31684_meta_data.csv", show_col_types = FALSE)
} else {
  # Download the gzipped file
  GET(meta_url, write_disk("data/GSE31684_meta_data.csv"))
  
  # Unzip and read the contents using tidyverse functions
  meta_data <- read_csv(gzfile("data/GSE31684_meta_data.csv"),  show_col_types = FALSE)
}
                          
# View the first few rows of the data
head(meta_data)
```

```{r}

dir.create("../data")

# Retrieve the data directly
bladder_data <- read_csv(file = "https://ftp.ncbi.nlm.nih.gov/geo/series/GSE31nnn/GSE31684/matrix/GSE31684_series_matrix.txt.gz")

# Write the data to disk
write_csv(x = bladder_data,
          file = "../data/bladder.csv")

meta_data<- read_csv("../data/bladder.csv")
head(meta_data)
```
