---
title: "03_augment.qmd"
format: html
editor: visual
---

## Library Load

```{r}
library(tidyverse)
library(httr)
library(readr)
```

## Data Load

```{r}

data_clean <- read_tsv("../data/02_dat_clean.tsv")

data_clean
```

## Creating new columns

```{r}


# Calculate the t-test p value of the gene_expression by comparring recurrent and non-recurrent for each gene:
gene_diff_exp <- data_clean_long %>%
  filter(gene %in% gene_variability) %>% # Filtering for genes that differenly expressed.
  group_by(gene) %>%
  mutate(p_value = t.test(gene_expression[Metastasis == 1], 
                          gene_expression[Metastasis == 0])$p.value) %>%
  mutate(log2_fold_change = mean(log2(gene_expression[Metastasis == 1])) - mean(log2(gene_expression[Metastasis == 0]))) %>% #Calculating the log2 fold change by using the mean.
  filter(p_value<0.01) # Filtering only for significant genes
  
gene_diff_exp
```
